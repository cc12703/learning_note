

# 自然语言算法

[TOC]


## 潜在语义分析（LSA）

### 概述
#### 特点
* 一种无监督学习方法
* 用于分析文本的话题
* 使用非概率的话题分析模型


### 基础
#### 话题分析
* 试图从大量的文本数据中发现潜在的话题，以话题向量表示文本的语义内容
* 用话题向量空间的度量更准确地表达文本的语义相似度

#### 单词向量空间
##### 定义
* 使用单词向量来表示文本的语义
* 向量每一维的值为该单词在文本中出现的频数或权值
* 权值通常使用 TF-IDF
* 使用向量的內积表示文本的相似度

##### 优点
* 模型简单，计算效率高（单词向量一般是稀疏的）

##### 缺点
* 相似度存在不精确的问题（存在一词多义、多词一义）


#### 话题向量空间
##### 定义
* 使用话题向量来表示文本的语义
* 向量每一维的值为该话题在文本中出现的权值
* 使用向量的內积表示文本的相似度

##### 线性变换
$$ X \approx T Y $$
说明
* $X$ 单词-文本矩阵
* $T$ 单词-话题矩阵
* $Y$ 话题-文本矩阵


### 算法
* 对单词-文本矩阵进行奇异值分解
* 分解后的矩阵中值有正有负

#### 公式
$$ X \approx U_k \Sigma_k V_k^T $$
说明
* k为话题个数
* $U_k$为话题向量空间
* $(\Sigma_k V_k^T)$为文本在话题空间的表示


### 非负矩阵分解
* 非负矩阵：矩阵的所有元素都是非负的

#### 模型
$$ X \approx W H $$
说明
* $X$ 单词-文本矩阵
* $W$ 话题空间向量，非负矩阵
* $H$ 文本在话题空间的表示，非负矩阵

#### 求解
* 矩阵分解可以形式化为最优化问题的求解

#### 损失函数
##### 平方损失
$$ ||A - B||^2 = \sum_{i,j} (a_{ij} - b_{ij})^2 $$

##### 散度损失
$$ 
D(A || B) = 
    \sum_{i,j} (a_{ij} log \frac{a_{ij}}{b_{ij}} - a_{ij} + b_{ij} ) 
$$

#### 求解算法
* 使用 乘法更新规则，交替对$W$和$H$进行更新




## 概率潜在语义分析（PLSA）

### 概述
#### 特点
* 一种无监督学习方法
* 利用概率生成模型对文本集合进行话题分析
* 使用隐变量来表示话题


### 模型
#### 基本想法
* 一个文本集合，每个文本讨论若干个话题，每个话题由若干个单词表示
* 通过对文本集合进行概率潜在语义分析，就能发现每个文本的话题
* 文本集合会转换为**文本-单词共现数据**（单词-文本矩阵）
* 文本数据基于概率模型（共现模型）产生

#### 生成模型
* 用于描述文本-单词共现数据生成的过程

##### 公式
$$ P(T) = \prod_{\omega,d} P(\omega,d)^{n(\omega,d)} $$
$$ P(\omega,d) = P(d) \sum_z P(z|d) P(\omega|z)   $$
说明
* $\omega$为单词，$d$为单词，$z$为话题
* $n(\omega,d)$为单词-文本对出现的次数
* $P(T)$为文本-单词共现数据的生成概率
* $P(d)$为生成文本的概率
* $P(z|d)$为从文本生成话题的概率
* $P(\omega|z)$为从话题生成单词的概率

##### 图示
![](https://gitee.com/cc12703/figurebed/raw/master/img/20210129194631.png)
说明
* $z$为隐变量
* $d$和$\omega$为观测变量

##### 生成共现数据步骤
1. 根据概率分布$P(d)$，从文本集合中随机选取一个文本$d$，共生成$N$个
1. 针对每个文本，执行以下操作
    1. 根据条件概率$P(z|d)$，从话题集合中随机选取一个话题$z$，共生成$L$个
    1. 根据条件概率$P(\omega|z)$，从单词集合中随机选取一个单词$\omega$


#### 共现模型
* 用于描述文本-单词共现数据拥有的模式

##### 公式
$$ P(T) = \prod_{\omega,d} P(\omega,d)^{n(\omega,d)} $$
$$ P(\omega,d) = \sum_{z \in Z} P(z) P(\omega|z) P(d|z)  $$

##### 图示
![](https://gitee.com/cc12703/figurebed/raw/master/img/20210129195327.png)



### 算法
#### 概述
* 使用EM算法，估计出$P(\omega_i|z_k)$和$P(z_k|d_j)$的值
* 在E步骤，计算Q函数
* 在M步骤，极大化Q函数

#### Q函数
* 定义：对数似然函数（完全数据）对条件分布（不完全数据）的期望

#### 极大化Q函数
1. 应用拉格朗日法，定义拉格朗日函数
1. 将函数对$P(\omega_i|z_k)$和$P(z_k|d_j)$ 求偏导数
1. 得到参数估计公式