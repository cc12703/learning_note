

# 神经网络

[TOC]

## 深度神经网络（DNN）

### 模型
#### 概述
* 在感知机模型扩展而来
* 将很多了神经单元连接为网络状

#### 神经元
##### 定义
* 多个输入进过一个线性关系，得到一个加权值
    * $ z = w_1 x_1 + w_2 x_2 + ... + w_n x_n + b $
* 加权值经过一个激活函数处理，得到输出

##### 图示
![](https://gitee.com/cc12703/figurebed/raw/master/img/20201225192424.png)

#### 基本结构
##### 定义
* 分成三类不同的层：输入层(一个)、隐藏层(多个)，输出层(一个)
* 层与层之间是全连接的：前一层的神经单元与下一层的所有神经单元都有连接

##### 图示
![](https://gitee.com/cc12703/figurebed/raw/master/img/20201225194007.png)


### 数学模型
#### 符号定义
| 符号 | 含义 | 
| -- | -- | 
| $x_i$ | 输入层的第i个神经元的输入 |
| $a_j^l$ | 第l层的第j个神经元的输出 |
| $z_j^l$ | 第l层的第j个神经元的加权值 |
| $b_j^l$ | 第l层的第j个神经元的偏置 |
| $w_{ji}^l$ | 第l-1层的第i个神经元到第l层的第j个神经元的输入权重 |

#### 图示
![](https://gitee.com/cc12703/figurebed/raw/master/img/20201225201751.png)


### 前向传播算法
* 利用上一层输出计算下一层的输出

#### 公式
$$
a^l = \sigma(W^l a^{l-1} + b^l)
$$
说明
* $W$为矩阵
* $b$, $a$为向量
* $\sigma$为激活函数

#### 流程
* 输入：总层数L，权重矩阵W，偏置向量b，输入向量x
* 输出：输出层的输出 $a^L$
* 步骤
    1. 初始化 $a^1 = x$
    2. for l=2 to L，计算$a^l$


### 反向传播算法
* 用于梯度下降法对损失函数求极小值
* 利用下一层的神经单元误差，来计算上一层的神经单元误差

#### 神经单元误差
$$
\delta_j^l = \frac{\partial C}{\partial z_j^l}
$$

#### 公式
$$
\delta^l = (W^{l+1})^T \delta^{l+1} \odot \sigma'(z^l)
$$

#### 梯度公式
$$
\frac{\partial C}{\partial w_{ji}^l} = \delta_j^l a_i^{l-1}
$$
$$
\frac{\partial C}{\partial b_j^l} = \delta_j^l
$$

#### 流程
* 输入：
    * 总层数L，总神经元个数，激活函数，损失函数，输入的m个样本
    * 迭代步长$\alpha$，最大迭代次数MAX，停止迭代阈值$\epsilon$
* 输出：
    * 权重矩阵$W$，偏置向量$b$
* 步骤
    1. 初始化$W$,$b$为随机值
    1. for iter to 1 to MAX
        1. 计算出各层的神经单元误差
            1. for i = 1 to m
            1. 设置 $a^1 = x$
            1. for l = 2 to L : 计算 $a_i^l$ 的值
            1. 通过损失函数，计算出输出层的 $\delta^L$
            1. for l = L-1 to 2 : 计算各层的 $\delta^l$值
        1. 更新权重、偏置
            1. for 𝑙 = 2 to L
            1. $ W^l = W^l - \alpha \delta^l (a^{l-1})^T $
            1. $ b^l = b^l -  \alpha \delta^l $
    1. 如果所有的$W$,$b$变化值都小于$\epsilon$，则跳出循环



### 函数选择
* 损失函数 + 激活函数

#### 组合1
* 均方差 + Sigmoid
* Sigmoid函数会导致算法收敛速度慢

#### 组合2
* 交叉熵 + Sigmoid
* 加快算法收敛速度

#### 组合3
* 对数似然 + softmax
* 处理多分类问题


## 卷积神经网络（CNN）
### 特点
* 隐藏层由多个具有结构的层组成
* 结构：卷积层 和1池化层


## 参考资料
* https://www.cnblogs.com/pinard/p/6418668.html