

# BMP格式


## 四个部分

* 文件头：长度固定，14个字节
* 信息头：长度固定，40个字节
* 调色板
* 图像数据


### 文件头

|  数据类型  | 名字| 含义 |
| :---: | :---: | :---: |
| u16 | type | 文件类型，值为 0x424D |
| u32 | size | 文件大小，全部的数据 |
| u16 | reserved1 | 保留未使用 |
| u16 | reserved2 | 保留未使用 |
| u32 | offBits | 文件头到图像数据的偏移量 |

### 信息头

|  数据类型  | 名字| 含义 |
| :---: | :---: | :---: |
| u32 | size | 该头长度 |
| u32 | width | 图像宽度（像素）|
| u32 | height | 图像高度（像素）|
| u16 | planes | 值为1 | 
| u16 | bitCount | 色深（1，4，8，24，32）|
| u32 | compression | 压缩方式 |
| u32 | sizeImage | 图像数据大小（实际的）|
| u32 | XPelsPerMeter | 目标设备的水平分辨率 | 
| u32 | YPelsPerMeter | 目标设备的垂直分辨率 | 
| u32 | ClrUsed | 实际用到的颜色数 |
| u32 | ClrImportant | 重要的颜色，0表示所有颜色都重要 | 


### 调色板

* 是一个数组，共有ClrUsed个元素
* 每个元素为一个RGBQuad结构

#### RGBQuad结构

|  数据类型  | 名字| 含义 |
| :---: | :---: | :---: |
| u8 | rgbBlue | 蓝色分量 | 
| u8 | rgbGreen | 绿色分量 |
| u8 | rgbRed | 红色分量 |
| u8 | rgbReserved | 保留 |

### 图像数据

* 每行数据的字节必须为4的倍数
* 文件数据是从图像最下面一行开始的
