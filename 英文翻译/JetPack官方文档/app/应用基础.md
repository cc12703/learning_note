

# 应用基础

* 原始文档：https://developer.android.com/guide/components/fundamentals

[TOC]


## 总体

### 概述
* 可以使用Kotlin, Java, C++语言来编写android应用程序
* SDK工具会将代码连同数据和资源文件一起编译成一个apk文件
* apk文件是一个android包，后缀名是.apk，格式为压缩包
* 一个apk文件包含了一个应用的所有内容，该文件可以在任何一个android支持的设备上进行安装

### 应用沙箱
每个应用都运行在自己的安全沙箱中，由以下安全特性进行保护
* 操作系统是一个多用户的Lisnux系统，每个应用都是一个不同用户
* 默认情况下系统会被每个应用分配一个唯一的Linux用户标识(操作系统使用该标识，对应用而言是未知的)
* 系统会给应用中的所有文件设置好权限，保证只有该应用才能读取这些文件
* 每个进程都有属于自己的虚拟机(VM)，所有每个应用的运行代码都是独立于其他应用的
* 默认情况下，每个应用都运行在自己的Linux进程中
    * 当应用的任何一个组件需要执行时，系统就会启动进程
    * 当应用的任何一个组件都不在需要时，系统会关闭进程
    * 当系统需要为其他应用腾出内存时，也会关闭进程


### 最小特权原则
* 默认情况下，每个应用都只能访问那些被请求过的组件，其他组件都不能访问
* 这些原则会创建一个应用不能访问没有授权的部分的安全的环境
* 应用可以通过以下方式来和其他应用共享数据、访问系统服务

#### 共享方法
* 给两个应用分配一个Linux用户标识是可能的，在这种情况下，这两个应用可以访问彼此的文件
    * 应用使用相同的用户标识，可以运行在同一个进程中，共享一个虚拟机，以节约系统资源
    * 两个应用必须使用相同的签名信息
* 应用可以请求权限来访问设备数据，像：定位、摄像头、蓝牙连接
    * 用户需要明确的允许这些权限




## 应用组件

### 概述
* 应用组件是android应用的必须的构建块
* 每个组件都是一个系统和用户该应用的入口点
* 一个组件会依赖于其他组件
* 组件分为四个类型：Activities，Services，广播接收器，内容提供者
* 每个类型都有不同的目的，有不同的生命周期（组件何时被创建、销毁）


### Activities
#### 定义
* 是一个用于和用户进行交互的入口点
* 表现为一个带有用户界面的单一屏幕

#### 例子
* 一个邮件应用有很多个activity
    * 一个activity用于显示一个新邮件列表
    * 一个activity用于写邮件
    * 一个activity用于阅读邮件
* 通过这些相互之间独立的acivity的协同工作，可以形成一个有粘性的用户体验
* 在获取到邮件应用的许可后，一个其他应用都可以启动这些activity中的任何一个
    * 一个摄像应用可以启动邮件应用中的写邮件activity，来允许用户共享一张图片

#### 简化交互
activity可以让应用和系统之间的交互更简单
* 可以跟踪到用户当前关心什么，保证该activity属于的进程一直运行着
* 可以知道前面运行过的进程包含了一些用户可能会返回的activity，这样系统会以更高的优先级来保持这些进程的存活
* 可以帮助应用处理所属进程被杀死的情况，用户可以返回到这些状态已经恢复的activity
* 可以提供一种在不同应用间实现用户交互流的方法，系统可以协调这些流